(function(b,a){b.ConditionalSelect=function(f,g,h,d,e){function c(m,j){var l,k;for(k=0;k<m.length;k+=1){l=a.createElement("option");l.value=m[k].value;l.innerHTML=m[k].label;if((!Array.isArray(d)&&m[k]["default"]==="true")||(Array.isArray(d)&&m[k].value&&d.indexOf(String(m[k].value))!==-1)){l.selected=true}j.appendChild(l)}return j}function i(){var r,q,w,m,t,v,n,p,j,u,l=[],o=[];f.innerHTML="";for(q=0;q<g.options.length;q+=1){if(g.options[q].selected){l.push(g.options[q].value);o.push(g.options[q].innerHTML)}}for(w=0;w<l.length;w+=1){n=l[w];if(h[n]){t=f;v=false;if(l.length>1){v=true;t=a.createElement("optgroup");t.label=o[n]||n}if(!Array.isArray(h[n])){p=v?(t.label+" - "):"";v=false;for(m in h[n]){t=a.createElement("optgroup");t.label=p+m;t=c(h[n][m],t);f.appendChild(t)}}else{t=c(h[n],t)}if(v){f.appendChild(t)}}}u=(f.className||"").split(" ");if(f.options.length===0&&u.indexOf("empty")===-1){u.push("empty");f.className=u.join(" ")}else{if(f.options.length>0&&u.indexOf("empty")!==-1){u.splice(u.indexOf("empty"),1);f.className=u.join(" ")}}if(e.includeBlankOption||f.options.length===0){r=a.createElement("option");r.value="";r.innerHTML=e.blankOptionLabel;if(f.options.length===0){f.appendChild(r)}else{f.insertBefore(r,f.options[0]).selected=true}}if(a.createEvent){j=a.createEvent("HTMLEvents");j.initEvent("change",true,true)}else{j=a.createEventObject();j.eventType="change"}j.eventName="change";if(a.createEvent){f.dispatchEvent(j)}else{f.fireEvent("on"+j.eventType,j)}}e=e||{};if(!e.hasOwnProperty("blankOptionLabel")){e.blankOptionLabel="-"}if(b.addEventListener){g.addEventListener("change",i,false);b.addEventListener("ajaxready",i,false)}else{if(b.attachEvent){g.attachEvent("change",i);b.attachEvent("ajaxready",i)}}i()};if(!Array.prototype.indexOf){Array.prototype.indexOf=function(c,d){if(this===undefined||this===null){throw new TypeError('"this" is null or not defined')}var e=this.length>>>0;d=+d||0;if(Math.abs(d)===Infinity){d=0}if(d<0){d+=e;if(d<0){d=0}}for(;d<e;d+=1){if(this[d]===c){return d}}return -1}}if(!Array.isArray){Array.isArray=function(c){return Object.prototype.toString.call(c)==="[object Array]"}}}(this,this.document));