(function(b,a){b.ConditionalSelect=function(f,g,h,d,e){function c(m,j){var l,k;for(k=0;k<m.length;k+=1){l=a.createElement("option");l.value=m[k].value;l.innerHTML=m[k].label;if((!Array.isArray(d)&&m[k]["default"]==="true")||(Array.isArray(d)&&m[k].value&&d.indexOf(String(m[k].value))!==-1)){l.selected=true}j.appendChild(l)}return j}function i(){var q,p,u,l,r,t,m,o,j=[],n=[];f.innerHTML="";for(p=0;p<g.options.length;p+=1){if(g.options[p].selected){j.push(g.options[p].value);n.push(g.options[p].innerHTML)}}for(u=0;u<j.length;u+=1){m=j[u];if(h[m]){r=f;t=false;if(j.length>1){t=true;r=a.createElement("optgroup");r.label=n[m]||m}if(Array.isArray(h[m])){o=t?(r.label+" - "):"";t=false;for(l in h[m]){r=a.createElement("optgroup");r.label=o+l;r=c(h[m][l],r);f.appendChild(r)}}else{r=c(h[m],r)}if(t){f.appendChild(r)}}}if(e.includeBlankOption||f.options.length===0){q=a.createElement("option");q.value="";q.innerHTML=e.blankOptionLabel;if(f.options.length===0){f.appendChild(q)}else{f.insertBefore(f.options[0],q)}}}e=e||{};if(!e.hasOwnProperty("blankOptionLabel")){e.blankOptionLabel="-"}if(b.addEventListener){g.addEventListener("change",i,false);b.addEventListener("ajaxready",i,false)}else{if(b.attachEvent){g.attachEvent("change",i);b.attachEvent("ajaxready",i)}}};if(!Array.prototype.indexOf){Array.prototype.indexOf=function(c,d){if(this===undefined||this===null){throw new TypeError('"this" is null or not defined')}var e=this.length>>>0;d=+d||0;if(Math.abs(d)===Infinity){d=0}if(d<0){d+=e;if(d<0){d=0}}for(;d<e;d+=1){if(this[d]===c){return d}}return -1}}if(!Array.isArray){Array.isArray=function(c){return Object.prototype.toString.call(c)==="[object Array]"}}}(this,this.document));